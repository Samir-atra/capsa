<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Find Representation Bias with capsa" href="2_Histogram-Classification.html" /><link rel="prev" title="Tutorials" href="../index.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>Eliminate Epistemic Uncertainty with capsa - capsa documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">capsa  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">capsa  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">üëã Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/installation.html">üíæ Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../risk_metrics/index.html">‚≠êÔ∏è Risk Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/basic_usage.html">üé¨ Basic Usage</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">üë©‚Äçüè´ Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Ensemble Wrapper (Classification)</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_Histogram-Classification.html">Histogram Wrapper (Classification)</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_MVE-Classification.html">MVE Wrapper (Classification)</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_MVE-Regression.html">MVE Wrapper (Regression)</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_High-Dimensional-Depth.html">High Level Introduction to Capsa with a Real World Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_OOD-Detection.html">Anomaly Detection (Advanced)</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_Composability.html">Composability (Advanced)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api_documentation/index.html">‚Äçüíª Metric Wrapper API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/BaseWrapper.html">BaseWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/RiskTensor.html">RiskTensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/MVEWrapper.html">MVEWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/VAEWrapper.html">VAEWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/EnsembleWrapper.html">EnsembleWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/DropoutWrapper.html">DropoutWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/HistogramWrapper.html">HistogramWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api_documentation/HistogramVAEWrapper.html">HistogramVAEWrapper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">üßø Contribute</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<p><img alt="bbb82cccb2e34d2b975b5cb53d8d5f90" src="https://i.ibb.co/2P3SLwK/colab.png" /> <a class="reference external" href="https://colab.research.google.com/github/themis-ai/capsa/blob/main/notebooks/1_Ensemble-Classification.ipynb">Run In Google Colab</a></p>
<section id="Eliminate-Epistemic-Uncertainty-with-capsa">
<h1>Eliminate Epistemic Uncertainty with <code class="docutils literal notranslate"><span class="pre">capsa</span></code><a class="headerlink" href="#Eliminate-Epistemic-Uncertainty-with-capsa" title="Permalink to this heading">#</a></h1>
<section id="A-Python-Library-for-Deep-Learning-Model-Risk-Management">
<h2>A Python Library for Deep Learning Model Risk Management<a class="headerlink" href="#A-Python-Library-for-Deep-Learning-Model-Risk-Management" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<section id="Section-1:-What-is-Epistemic-Uncertainty?">
<h3>Section 1: What is Epistemic Uncertainty?<a class="headerlink" href="#Section-1:-What-is-Epistemic-Uncertainty?" title="Permalink to this heading">#</a></h3>
<p>Epistemic uncertainty reflects the uncertainty that is inherent in a model‚Äôs predictions due to the limited amount of information that the model has. This is in contrast to aleatoric uncertainty, which is uncertainty that arises from randomness or inherent noise in the data.</p>
<p>Knowing the epistemic uncertainty of a model can be important for a number of reasons:</p>
<ol class="arabic simple">
<li><p>It can help us to understand the limitations of the model and know when it is likely to make inaccurate predictions. This can be useful for identifying situations where the model should be used with caution, or where it may not be appropriate to use it at all.</p></li>
<li><p>Knowing the epistemic uncertainty of a model can also help us to identify areas where the model is unsure of its predictions. This can be useful for identifying areas where the model may benefit from additional training data, or where it may be necessary to use a different model altogether.</p></li>
</ol>
<hr class="docutils" />
</section>
<section id="Section-2:-capsa-(a-Python-Library-for-Mitigating-Uncertainty)">
<h3>Section 2: <code class="docutils literal notranslate"><span class="pre">capsa</span></code> (a Python Library for Mitigating Uncertainty)<a class="headerlink" href="#Section-2:-capsa-(a-Python-Library-for-Mitigating-Uncertainty)" title="Permalink to this heading">#</a></h3>
<p>Capsa is a convenient model wrapping tool. It wraps around predefined Keras models, adding the ability to perform risk analysis on the predictions made by those models, and therefore letting developers make more informed decisions about how to use it in their applications.</p>
<p><code class="docutils literal notranslate"><span class="pre">capsa</span></code> allows users to select a MetricWrapper that augments model with a corresponding risk-metric:</p>
<ul class="simple">
<li><p><strong>Representation Bias</strong>: Bias of a dataset that exists in a target feature space in the model</p>
<ul>
<li><p>HistogramWrapper</p></li>
</ul>
</li>
<li><p><strong>Aleatoric Uncertainty</strong>: Uncertainty that results from randomness or inherent noise in the data</p>
<ul>
<li><p>MVEWrapper</p></li>
</ul>
</li>
<li><p><strong>Epistemic Uncertainty</strong>: Uncertainty in a model‚Äôs predictions due to model limitations or limited data</p>
<ul>
<li><p>DropoutWrapper</p></li>
<li><p>EnsembleWrapper</p></li>
<li><p>VAEWrapper</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
</section>
<section id="Section-3:-EnsembleWrapper()">
<h3>Section 3: <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper()</span></code><a class="headerlink" href="#Section-3:-EnsembleWrapper()" title="Permalink to this heading">#</a></h3>
<p><img alt="d6b63d5a373a4ed8b4aec4a2311aa469" src="https://github.com/themis-ai/capsa/raw/main/notebooks/assets/EnsembleWrapper.png" /></p>
<p><code class="docutils literal notranslate"><span class="pre">EnsembleWrapper()</span></code> takes in a model and copies the architecture <code class="docutils literal notranslate"><span class="pre">num_members</span></code> times. This new ensemble architecture is parallelizable with tensorflow. Since each individual model (ensemble) has different initialization weights, they will converge towards different points in the loss surface as they are being trained. Therefore, given an input, each of these ensembles will output different predictions. The variance of all ensemble outputs gives us the epistemic uncertainty, <strong>R</strong>.</p>
<hr class="docutils" />
</section>
<section id="Section-4:-How-to-use-capsa">
<h3>Section 4: How to use <code class="docutils literal notranslate"><span class="pre">capsa</span></code><a class="headerlink" href="#Section-4:-How-to-use-capsa" title="Permalink to this heading">#</a></h3>
<section id="Installation-and-Import">
<h4>Installation and Import<a class="headerlink" href="#Installation-and-Import" title="Permalink to this heading">#</a></h4>
<p>First of all, let‚Äôs install <code class="docutils literal notranslate"><span class="pre">capsa</span></code> to our work environment with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">capsa</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!pip install capsa

!git clone --depth 1 https://github.com/themis-ai/capsa.git
%cd /content/capsa/notebooks/utils/
</pre></div>
</div>
</div>
<p>Then, we can import all the necessary libraries, as well as the <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from matplotlib import pyplot as plt
import tensorflow as tf
import helper
from capsa import EnsembleWrapper
</pre></div>
</div>
</div>
</section>
<section id="Loading-a-Dataset">
<h4>Loading a Dataset<a class="headerlink" href="#Loading-a-Dataset" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple" start="2">
<li><p>You would have your own training and test dataset ready.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>(x_train, y_train), (x_test, y_test) = helper.generate_moon_data_classification()
</pre></div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>You might want to visualize your own dataset to get a better understanding of your own data. So you plot your training dataset into a graph.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>helper.plot_for_moons(x_train, y_train)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_Ensemble-Classification_25_0.png" src="../../_images/tutorials_notebooks_1_Ensemble-Classification_25_0.png" />
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>Just like in your normal workflow, you‚Äôd have your own pre-defined model.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>user_model = helper.generate_model_mve_classification()
</pre></div>
</div>
</div>
</section>
<section id="Wrapping-Keras-Model-with-EnsembleWrapper()">
<h4>Wrapping Keras Model with EnsembleWrapper()<a class="headerlink" href="#Wrapping-Keras-Model-with-EnsembleWrapper()" title="Permalink to this heading">#</a></h4>
<p>So far, we‚Äôve only dealt with tensorflow and defined our model as a Keras.Model variable. We can pass this variable as a parameter to <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper(model,num_members=10)</span></code>, which augments the model to become risk-aware. The new <code class="docutils literal notranslate"><span class="pre">wrapped_model</span></code> variable can be used just like the initial model during training and inference.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>wrapped_model = EnsembleWrapper(user_model,num_members=10)
</pre></div>
</div>
</div>
</section>
<section id="Compiling-and-Fitting">
<h4>Compiling and Fitting<a class="headerlink" href="#Compiling-and-Fitting" title="Permalink to this heading">#</a></h4>
<p>Just like how we might do in a Keras model, we will predefine an optimizer as well as a loss_function to use. We can compile our wrapped model using keras provided tools.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>wrapped_model.compile(
            optimizer=tf.keras.optimizers.Adam(),
            loss=tf.keras.losses.BinaryCrossentropy(),
            metrics=[tf.keras.metrics.BinaryAccuracy()]
                     )
</pre></div>
</div>
</div>
<p>Now, let‚Äôs fit our model with the training data that we initially loaded. As it‚Äôs fitting, you can manually inspect the loss metrics of each ensemble.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>wrapped_model.fit(x_train,tf.one_hot(y_train,2),epochs=3)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/3
1313/1313 [==============================] - 14s 6ms/step - usermodel_0_loss: 0.3939 - usermodel_0_binary_accuracy: 0.8311 - usermodel_1_loss: 0.3978 - usermodel_1_binary_accuracy: 0.8311 - usermodel_2_loss: 0.4295 - usermodel_2_binary_accuracy: 0.8311 - usermodel_3_loss: 0.3667 - usermodel_3_binary_accuracy: 0.8310 - usermodel_4_loss: 0.4082 - usermodel_4_binary_accuracy: 0.8310 - usermodel_5_loss: 0.4118 - usermodel_5_binary_accuracy: 0.8310 - usermodel_6_loss: 0.4103 - usermodel_6_binary_accuracy: 0.8310 - usermodel_7_loss: 0.3932 - usermodel_7_binary_accuracy: 0.8311 - usermodel_8_loss: 0.3661 - usermodel_8_binary_accuracy: 0.8311 - usermodel_9_loss: 0.3550 - usermodel_9_binary_accuracy: 0.8312
Epoch 2/3
1313/1313 [==============================] - 7s 5ms/step - usermodel_0_loss: 0.1847 - usermodel_0_binary_accuracy: 0.9219 - usermodel_1_loss: 0.1997 - usermodel_1_binary_accuracy: 0.9219 - usermodel_2_loss: 0.2788 - usermodel_2_binary_accuracy: 0.9219 - usermodel_3_loss: 0.1626 - usermodel_3_binary_accuracy: 0.9219 - usermodel_4_loss: 0.2229 - usermodel_4_binary_accuracy: 0.9219 - usermodel_5_loss: 0.2272 - usermodel_5_binary_accuracy: 0.9219 - usermodel_6_loss: 0.1916 - usermodel_6_binary_accuracy: 0.9219 - usermodel_7_loss: 0.2297 - usermodel_7_binary_accuracy: 0.9219 - usermodel_8_loss: 0.1754 - usermodel_8_binary_accuracy: 0.9219 - usermodel_9_loss: 0.1646 - usermodel_9_binary_accuracy: 0.9219
Epoch 3/3
1313/1313 [==============================] - 7s 5ms/step - usermodel_0_loss: 0.1355 - usermodel_0_binary_accuracy: 0.9433 - usermodel_1_loss: 0.1504 - usermodel_1_binary_accuracy: 0.9433 - usermodel_2_loss: 0.2053 - usermodel_2_binary_accuracy: 0.9433 - usermodel_3_loss: 0.1227 - usermodel_3_binary_accuracy: 0.9433 - usermodel_4_loss: 0.1650 - usermodel_4_binary_accuracy: 0.9433 - usermodel_5_loss: 0.1668 - usermodel_5_binary_accuracy: 0.9433 - usermodel_6_loss: 0.1421 - usermodel_6_binary_accuracy: 0.9433 - usermodel_7_loss: 0.1657 - usermodel_7_binary_accuracy: 0.9433 - usermodel_8_loss: 0.1324 - usermodel_8_binary_accuracy: 0.9433 - usermodel_9_loss: 0.1276 - usermodel_9_binary_accuracy: 0.9433
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;keras.callbacks.History at 0x199cea81fc0&gt;
</pre></div></div>
</div>
<p>Now that our wrapped model has been trained, we can continue on how to use it.</p>
<hr class="docutils" />
</section>
<section id="Inference">
<h4>Inference<a class="headerlink" href="#Inference" title="Permalink to this heading">#</a></h4>
<p>Note: In the example below, we used a function called <code class="docutils literal notranslate"><span class="pre">get_grid()</span></code> . We used this function to generate samples in the input space. These samples are passed to our model to visually observe epistemic uncertainty in this space.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>mesh_grid = helper.get_grid()
output = wrapped_model(mesh_grid)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>helper.plot_ensemble_classification(output,mesh_grid,x_test,y_test)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_1_Ensemble-Classification_41_0.png" src="../../_images/tutorials_notebooks_1_Ensemble-Classification_41_0.png" />
</div>
</div>
<p>What we can see here is that ensembles have high variance in more yellow locations in this space, giving us a clear understanding of the epistemic uncertainty of our model.</p>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="2_Histogram-Classification.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Find Representation Bias with <code class="docutils literal notranslate"><span class="pre">capsa</span></code></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorials</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Themis AI Inc
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Eliminate Epistemic Uncertainty with <code class="docutils literal notranslate"><span class="pre">capsa</span></code></a><ul>
<li><a class="reference internal" href="#A-Python-Library-for-Deep-Learning-Model-Risk-Management">A Python Library for Deep Learning Model Risk Management</a><ul>
<li><a class="reference internal" href="#Section-1:-What-is-Epistemic-Uncertainty?">Section 1: What is Epistemic Uncertainty?</a></li>
<li><a class="reference internal" href="#Section-2:-capsa-(a-Python-Library-for-Mitigating-Uncertainty)">Section 2: <code class="docutils literal notranslate"><span class="pre">capsa</span></code> (a Python Library for Mitigating Uncertainty)</a></li>
<li><a class="reference internal" href="#Section-3:-EnsembleWrapper()">Section 3: <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper()</span></code></a></li>
<li><a class="reference internal" href="#Section-4:-How-to-use-capsa">Section 4: How to use <code class="docutils literal notranslate"><span class="pre">capsa</span></code></a><ul>
<li><a class="reference internal" href="#Installation-and-Import">Installation and Import</a></li>
<li><a class="reference internal" href="#Loading-a-Dataset">Loading a Dataset</a></li>
<li><a class="reference internal" href="#Wrapping-Keras-Model-with-EnsembleWrapper()">Wrapping Keras Model with EnsembleWrapper()</a></li>
<li><a class="reference internal" href="#Compiling-and-Fitting">Compiling and Fitting</a></li>
<li><a class="reference internal" href="#Inference">Inference</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>