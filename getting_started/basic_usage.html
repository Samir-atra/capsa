<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Tutorials" href="../tutorials/index.html" /><link rel="prev" title="Risk Metrics" href="../risk_metrics/index.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>Basic Usage - capsa documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">capsa  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">capsa  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">üëã Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">üíæ Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../risk_metrics/index.html">‚≠êÔ∏è Risk Metrics</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">üé¨ Basic Usage</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">üë©‚Äçüè´ Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/notebooks/1_Ensemble-Classification.html">Ensemble Wrapper (Classification)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/notebooks/2_Histogram-Classification.html">Histogram Wrapper (Classification)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/notebooks/3_MVE-Classification.html">MVE Wrapper (Classification)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/notebooks/4_MVE-Regression.html">MVE Wrapper (Regression)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/notebooks/5_High-Dimensional-Depth.html">High Level Introduction to Capsa with a Real World Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/notebooks/6_OOD-Detection.html">Anomaly Detection (Advanced)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/notebooks/7_Composability.html">Composability (Advanced)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api_documentation/index.html">‚Äçüíª Metric Wrapper API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/BaseWrapper.html">BaseWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/RiskTensor.html">RiskTensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/MVEWrapper.html">MVEWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/VAEWrapper.html">VAEWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/EnsembleWrapper.html">EnsembleWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/DropoutWrapper.html">DropoutWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/HistogramWrapper.html">HistogramWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_documentation/HistogramVAEWrapper.html">HistogramVAEWrapper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">üßø Contribute</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="basic-usage">
<span id="getting-started-basic-usage"></span><h1>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this heading">#</a></h1>
<p>Eager to make your models risk-aware? This page will get you started with <strong>capsa</strong>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure you have the package <a class="reference external" href="installation.html">installed</a> before you apply the next steps.</p>
</div>
<section id="minimal-application">
<h2>Minimal Application<a class="headerlink" href="#minimal-application" title="Permalink to this heading">#</a></h2>
<p>Let‚Äôs start with a minimal example. We will use <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper()</span></code>, which helps us uncover <strong>epistemic uncertainty</strong> of a model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">capsa</span> <span class="kn">import</span> <span class="n">EnsembleWrapper</span>

<span class="n">wrapped_model</span> <span class="o">=</span> <span class="n">EnsembleWrapper</span><span class="p">(</span><span class="n">original_model</span><span class="p">,</span><span class="n">num_members</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">wrapped_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="n">wrapped_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>What did we do?</p>
<ol class="arabic simple">
<li><p>We imported <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper</span></code> class from capsa.</p></li>
<li><p>We initialized the <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper()</span></code> class. We passed our Tensorflow model. We also passed the arguments <code class="docutils literal notranslate"><span class="pre">num_members=5</span></code>. This means we want to wrap our original model with an ensemble of 5 models.</p></li>
<li><p>We compiled the wrapped model using the same loss, optimizer and metrics that we would use on our original_model ‚Äì nothing changes! Our wrapped model takes care of the metric-specific loss and optimization changes so you don‚Äôt need to.</p></li>
<li><p>We started the training process by calling the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method on our wrapped model. This is the same as calling the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method on our <code class="docutils literal notranslate"><span class="pre">original_model</span></code>.</p></li>
</ol>
<p>Since we can treat our wrapped model as a normal Tensorflow Graph, we can also use custom training loops on our MetricWrapper:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrapped_model</span> <span class="o">=</span> <span class="n">EnsembleWrapper</span><span class="p">(</span><span class="n">original_model</span><span class="p">,</span><span class="n">num_members</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">epochs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Start of epoch </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span><span class="p">,))</span>

    <span class="c1"># Iterate over the batches of the dataset.</span>
    <span class="k">for</span> <span class="n">step</span><span class="p">,</span> <span class="p">(</span><span class="n">x_batch_train</span><span class="p">,</span> <span class="n">y_batch_train</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">):</span>

        <span class="c1"># Open a GradientTape to record the operations run</span>
        <span class="c1"># during the forward pass, which enables auto-differentiation.</span>
        <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>

            <span class="c1"># Run the forward pass of the layer.</span>
            <span class="c1"># The operations that the layer applies</span>
            <span class="c1"># to its inputs are going to be recorded</span>
            <span class="c1"># on the GradientTape.</span>
            <span class="n">logits</span> <span class="o">=</span> <span class="n">wrapped_model</span><span class="p">(</span><span class="n">x_batch_train</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Logits for this minibatch</span>

            <span class="c1"># Compute the loss value for this minibatch.</span>
            <span class="n">loss_value</span> <span class="o">=</span> <span class="n">wrapped_model</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">y_batch_train</span><span class="p">,</span> <span class="n">logits</span><span class="p">)</span>

        <span class="c1"># Use the gradient tape to automatically retrieve</span>
        <span class="c1"># the gradients of the trainable variables with respect to the loss.</span>
        <span class="n">grads</span> <span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss_value</span><span class="p">,</span> <span class="n">wrapped_model</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">)</span>

        <span class="c1"># Run one step of gradient descent by updating</span>
        <span class="c1"># the value of the variables to minimize the loss.</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">wrapped_model</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">))</span>
</pre></div>
</div>
<section id="metricwrapper">
<h3><code class="docutils literal notranslate"><span class="pre">MetricWrapper()</span></code><a class="headerlink" href="#metricwrapper" title="Permalink to this heading">#</a></h3>
<p>As we have seen, wrapping a Tensorflow model with a MetricWrapper is as simple as initializing the said wrapper and passing our own original model. Metric Wrappers are designed to dissect your model and training parameters and abstract away all of the architecture changes, loss modifications so you don‚Äôt need to change any of that!</p>
</section>
<section id="wrapper-model-output">
<h3>Wrapper Model Output<a class="headerlink" href="#wrapper-model-output" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">wrapped_model</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">y_hat</span><span class="p">)</span> <span class="c1">#Prints Ensemble Wrapper prediction for the sample</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">epistemic</span><span class="p">)</span> <span class="c1">#Prints Ensemble Wrapper risk metric for the sample</span>
</pre></div>
</div>
<p>Each <strong>Metric Wrapper</strong> output is a RiskTensor object. The RiskTensor object contains the following attributes:</p>
<p><code class="docutils literal notranslate"><span class="pre">y_hat</span></code>: The prediction of the model for the sample.</p>
<p><code class="docutils literal notranslate"><span class="pre">aleatoric</span></code>: The aleatoric uncertainty of the model for the sample.</p>
<p><code class="docutils literal notranslate"><span class="pre">epistemic</span></code>: The epistemic uncertainty of the model for the sample.</p>
<p><code class="docutils literal notranslate"><span class="pre">bias</span></code>: The representation bias of the model for the sample.</p>
<p>Since we used <code class="docutils literal notranslate"><span class="pre">EnsembleWrapper()</span></code> in our example, which is a wrapper that measures epistemic uncertainty, we can access the risk metric of the model for the sample by calling <code class="docutils literal notranslate"><span class="pre">output.epistemic</span></code>.</p>
</section>
<section id="metric-wrapper">
<h3>Metric Wrapper<a class="headerlink" href="#metric-wrapper" title="Permalink to this heading">#</a></h3>
<p>As we‚Äôve mentioned previously, a <strong>Metric Wrapper</strong> implements the corresponding risk metric. They are designed to be composable with each other. This means that we can combine multiple Metric Wrappers in a single wrapped model, giving us access to multiple risk metrics.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There are limitations on composability within metric wrappers. For example, Dropout Wrapper is not compatible with other metric wrappers due to the way dropout is implemented after each layer in the feature extractor. These will be addressed in future updates.</p>
</div>
<section id="representation-bias">
<h4>Representation Bias<a class="headerlink" href="#representation-bias" title="Permalink to this heading">#</a></h4>
<p>Bias risk metric aims to estimate the density of our data in order to identify potential imbalances and underrepresented regions of our data landscape. There are many ways to perform density estimation with neural networks. Capsa supports a <a class="reference external" href="../api_documentation/HistogramWrapper.html">Histogram Wrapper</a> to progressively store activations of a target hidden layer of the model in order to measure density within a discrete histogram. The histogram is then used to compute the representation bias of a given sample during inference time. For higher dimensional datasets (e.g., images, etc) the Histogram Wrapper can be seamlessly composed with the a VAE Wrapper in order to learn a histogram over the latent space from a variational autoencoder (VAE).</p>
</section>
<section id="epistemic-uncertainty">
<h4>Epistemic Uncertainty<a class="headerlink" href="#epistemic-uncertainty" title="Permalink to this heading">#</a></h4>
<p>Epistemic Uncertainty risk metric measure the uncertainty of the model‚Äôs prediction ‚Äì capturing how much we can trust the model. There are many ways to estimate epistemic uncertainty, ranging from Bayesian NNs and ensemble sampling, to noise contrastive methods and evidential learning. Capsa aims to automate the conversion of your model to use any of these types methodologies seamlessly into your training and deployment pipeline, without worrying about the underlying low-level details of the methods. We currently support the following methods, with more community methods coming soon!</p>
<p>Dropout Wrapper (Srivastava et al., 2014) adds dropout layers to the model. During inference time, we run the model multiple times with the same input. This gives us both prediction and an estimate of the epistemic uncertainty (variance of the output) of the model.</p>
<p>Ensemble Wrapper (Lakshminarayanan et al., 2017) is the gold standard approach to accurately estimating epistemic uncertainty. It is implemented by training multiple models with same architecture, but different weights. During inference time, we pass a sample through each model(ensemble). This gives us both prediction and an estimate of the epistemic uncertainty.</p>
<p>VAE Wrapper adds a decoder to a given model. The decoder is trained to reconstruct the input. During inference time, we pass a sample through the model and the decoder. The reconstruction loss between decoder output and the given input gives us an estimate of the epistemic uncertainty.</p>
<blockquote>
<div><p><a class="reference external" href="../api_documentation/DropoutWrapper.html">Dropout Wrapper</a></p>
<p><a class="reference external" href="../api_documentation/EnsembleWrapper.html">Ensemble Wrapper</a></p>
<p><a class="reference external" href="../api_documentation/VAEWrapper.html">VAE Wrapper</a></p>
</div></blockquote>
</section>
<section id="aleatoric-uncertainty-label-noise">
<h4>Aleatoric Uncertainty (Label Noise)<a class="headerlink" href="#aleatoric-uncertainty-label-noise" title="Permalink to this heading">#</a></h4>
<blockquote>
<div><p><a class="reference external" href="../api_documentation/MVEWrapper.html">MVE Wrapper</a></p>
</div></blockquote>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../tutorials/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorials</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../risk_metrics/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Risk Metrics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Themis AI Inc
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Basic Usage</a><ul>
<li><a class="reference internal" href="#minimal-application">Minimal Application</a><ul>
<li><a class="reference internal" href="#metricwrapper"><code class="docutils literal notranslate"><span class="pre">MetricWrapper()</span></code></a></li>
<li><a class="reference internal" href="#wrapper-model-output">Wrapper Model Output</a></li>
<li><a class="reference internal" href="#metric-wrapper">Metric Wrapper</a><ul>
<li><a class="reference internal" href="#representation-bias">Representation Bias</a></li>
<li><a class="reference internal" href="#epistemic-uncertainty">Epistemic Uncertainty</a></li>
<li><a class="reference internal" href="#aleatoric-uncertainty-label-noise">Aleatoric Uncertainty (Label Noise)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>